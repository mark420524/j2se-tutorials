### 28.流

​         java程序中，对于数据的输入、输出操作均已“流”的方式进行。jdk提供了各种流类，用于获取不同的数据类型，如：文件流，网络流，内存流等。

#### 28.1 流的分类

* 案处理数据单位不同分为：字节流、字符流
* 数据流方向不同分为：输入流、输出流
* 功能不同可以分为：节点流、处理流

   jdk所提供的流类型位于`java.io`内的都分别继承以下表格中的流类型

|  类型  |    字节流    | 字符流 |
| :----: | :----------: | :----: |
| 输入流 | InputStream  | Reader |
| 输出流 | OutputStream | Writer |

**节点流**：

​        从一个特定的数据源读写数据，是直接操作文件、网络、内存的流。`FileInputStream`和`FileOutputSteam`直接从文件中读取或往文件中写入字节流。

![节点流示意图](image/stream1.png)

**处理流**：

​       ”连接“在已存在的流之上通过对数据的处理为程序提供强劲的读写功能。例如`BufferedInputStream`和`BufferedOutputStream`，使用已经存在的节点流来构造，提供带缓冲的读写，提高了读写的效率，以及`DataInputStream`和`DataOutputStream`，使用已经存在的节点流来构造，提供了读写Java中的基本数据类型的功能。他们都属于处理流。

![处理流示意图](image/stream2.png)

例子：

```java

import java.io.*;

public class Test{
    public static void main(String[] args) {
        try (
            // 节点流FileOutputStream直接以a.txt作为数据源操作
            FileOutputStream fileOutputStream = new FileOutputStream("a.txt");
            // 过滤流BufferedOutputStream进一步装饰节点流，提供缓冲写
            BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(
                fileOutputStream);
            // 过滤流DataOutputStream进一步装饰过滤流，使其提供基本数据类型的写
            DataOutputStream out = new DataOutputStream(bufferedOutputStream);
        )
        {
            out.writeInt(3);
            out.writeBoolean(true);
            out.flush();
            // 此处输入节点流，过滤流正好跟上边输出对应，读者可举一反三
            DataInputStream in = new DataInputStream(new BufferedInputStream(
                new FileInputStream("a.txt")));
            System.out.println(in.readInt());
            System.out.println(in.readBoolean());
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

```

Note：**try() 小括号里面的代码是jdk8的新特性，里面的流在代码执行完毕后jvm会自动关闭，不用再写finally代码块**

继承自`InputStream` 的流都是用于向程序中输入数据，且数据的单位都是字节(byte=8bit)，如图，深色的为节点流，浅色的为处理流。

![input](image/stream3.png)

`InputStream`的基本方法：

```java
//读取一个字节并一整数形式返回(0-255)
//如果返回-1表示读取到流的末尾
int read() throws IOException
//读取一系列字节并存储在数组buffer中
//返回实际读取到字节数，如果到末尾返回-1
int read(byte[] buffer) throws IOException
//从offset位置开始读取length个字节，并存储在buffer字节数组中
//返回实际读取到字节数，如果到末尾返回-1    
int read(byte[] buffer, int offset,int length) throws IOException
//关闭流释放资源，一般在finally代码块中执行
void close() throws IOException
//跳过n个字节不读，返回实际跳过的字节数
long skip(long n) throws IOException
```



继承自`OutputStream` 的流都是程序向外输出数据，且数据的单位都是字节(byte=8bit)，如图，深色的为节点流，浅色的为处理流。

![output](image/stream31.png)

`OutputStream`的基本方法：

```java
//向输出流中写入一个字节数据，该数据为参数的低8位
void write(int i) throws IOException
//将字节类型数组数据写入输出流
void write(byte[] b) throws IOException
//将一个字节类型数组数据从指定位置offset开始length个字节写入到输出流
void write(byte[] b,int offset, int length) throws IOException
//关闭流释放资源，一般在finally代码块里面执行
void close() throws IOException
//输出流的缓冲数据立即写入到目的地
void flush() throws IOException
```



继承自`Reader` 的流都是用于向程序中输入数据，且数据的单位都是字符(2byte=16bit)，如图，深色的为节点流，浅色的为处理流。

![reader](image/stream4.png)

`Reader`的基本方法：

```java
//读取一个字符并一整数形式返回(0-65535)
//如果返回-1表示读取到流的末尾
int read() throws IOException
//读取一系列字符并存储在数组buffer中
//返回实际读取到字符数，如果到末尾返回-1
int read(char[] buffer) throws IOException
//从offset位置开始读取length个字符，并存储在buffer字符数组中
//返回实际读取到字符数，如果到末尾返回-1    
int read(char[] buffer, int offset,int length) throws IOException
//关闭流释放资源，一般在finally代码块中执行
void close() throws IOException
//跳过n个字符不读，返回实际跳过的字符数
long skip(long n) throws IOException
```



继承自`Writer` 的流都是用于程序中向外输出数据，且数据的单位都是字符(2byte=16bit)，如图，深色的为节点流，浅色的为处理流。

![reader](image/stream41.png)

`Writer`的基本方法：

```java
//向输出流中写入一个字符数据，该数据为参数的低16位
void write(int i) throws IOException
//将字符类型数组数据写入输出流
void write(char[] cbuf) throws IOException
//将一个字符类型数组数据从指定位置offset开始length个字符写入到输出流
void write(char[] cbuf,int offset, int length) throws IOException
//将一个字符串中字符写入到输出流
void write(String str) throws IOException
//将一个字符串从offset开始的length个字符写出到输出流
void write(String str,int offset, int length) throws IOException
//关闭流释放资源，一般在finally代码块里面执行
void close() throws IOException
//输出流的缓冲数据立即写入到目的地
void flush() throws IOException
```

